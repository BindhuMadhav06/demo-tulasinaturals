{% extends "base.html" %}{% block content %}
<h2 class="text-3xl font-bold text-green-700 mb-6 text-center">Our Herbal Products</h2>

<form method="get" class="flex justify-between mb-6">
  <div>
    <select name="cat" onchange="this.form.submit()" class="px-3 py-2 border rounded shadow text-green-800">
      {% for c in ['All','Soap','Oil','Gel'] %}
      <option value="{{c}}" {% if category==c %}selected{% endif %}>{{c}}</option>{% endfor %}
    </select>
  </div>
  <div>
    <select name="sort" onchange="this.form.submit()" class="px-3 py-2 border rounded shadow text-green-800">
      <option value="none">Sort By</option>
      <option value="low-high" {% if sort=='low-high' %}selected{% endif %}>Price: Low→High</option>
      <option value="high-low" {% if sort=='high-low' %}selected{% endif %}>Price: High→Low</option>
    </select>
  </div>
</form>

<div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-8">
  {% for p in products %}
  <div class="bg-white border border-green-100 shadow-xl rounded-xl overflow-hidden transform hover:scale-105 transition duration-300">
    <img src="{{p.img}}" class="w-full h-60 object-cover">
    <div class="p-4">
      <h3 class="text-xl font-bold text-green-800">{{p.name}}</h3>
      <p class="text-gray-600 text-sm">100% Herbal, Chemical‑Free</p>
      <div class="flex justify-between items-center mt-4">
        <span class="text-green-700 font-semibold">₹{{p.price}}</span>
        <div class="space-x-2">
          <a href="/add_to_cart/{{p.id}}" class="bg-green-600 text-white px-3 py-1 rounded-full">Add to Cart</a>
          <button onclick="openModal({{p.id}})" class="text-green-600 hover:underline text-sm">View Details</button>
        </div>
      </div>
    </div>
  </div>
  {% endfor %}
</div>

<!-- Modal -->
<div id="modal" class="fixed inset-0 hidden items-center justify-center bg-black bg-opacity-50">
  <div class="bg-white rounded-lg w-11/12 md:w-1/2 p-6 relative">
    <button onclick="closeModal()" class="absolute top-4 right-4 text-gray-600">&times;</button>
    <img id="modal-img" class="w-full h-64 object-cover rounded mb-4">
    <h3 id="modal-name" class="text-2xl font-bold text-green-800"></h3>
    <p class="mb-4">100% herbal, chemical‑free, premium quality.</p>
    <span id="modal-price" class="text-green-700 text-xl font-semibold"></span>
  </div>
</div>

<script>
const products = {{ products|tojson }};
function openModal(id){
  const p = products.find(x=>x.id===id);
  document.getElementById("modal-img").src=p.img;
  document.getElementById("modal-name").innerText=p.name;
  document.getElementById("modal-price").innerText="₹"+p.price;
  document.getElementById("modal").classList.remove("hidden");
}
function closeModal(){ document.getElementById("modal").classList.add("hidden"); }
</script>
{% endblock %}
